# üöÄ –ù–ê–ß–ê–¢–¨ –†–ï–ê–õ–¨–ù–´–ô –¢–ï–°–¢ –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò

## ‚úÖ –í—Å—ë –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç—É!

–í—Å–µ credentials —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
- ‚úÖ ESKIZ (–¥–ª—è SMS)
- ‚úÖ iiko API (–¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤)

---

## üß™ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ (5 –º–∏–Ω—É—Ç):

### –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

```powershell
cd D:\27\loyalty-backend
.\test-full-registration.ps1
```

**–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:**
- ‚úÖ ESKIZ Balance: <—á–∏—Å–ª–æ> (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å > 0 –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS)
- ‚úÖ IIKO_API_LOGIN: SET
- ‚úÖ IIKO_ORGANIZATION_ID: SET
- ‚úÖ iiko connection OK

---

### –®–ê–ì 2: –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: **`http://localhost:4028/signup`**
2. –û—Ç–∫—Ä–æ–π—Ç–µ **DevTools (F12)** ‚Üí **Console** –∏ **Network** tabs

---

### –®–ê–ì 3: –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è

1. **–í–≤–µ–¥–∏—Ç–µ –†–ï–ê–õ–¨–ù–´–ô –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞** (–≤–∞—à –∏–ª–∏ —Ç–µ—Å—Ç–æ–≤—ã–π)
   - –§–æ—Ä–º–∞—Ç: `+998 90 123 45 67`
2. –ù–∞–∂–º–∏—Ç–µ **"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥"**
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω** - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ SMS —Å –∫–æ–¥–æ–º
4. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ SMS
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - –ò–º—è
   - –§–∞–º–∏–ª–∏—è
   - –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
6. –ù–∞–∂–º–∏—Ç–µ **"–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"**

---

### –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (DevTools):**
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —É—Å–ø–µ—à–Ω—ã (Status 200)
- ‚úÖ –í localStorage —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ:
  - `customerId`
  - `customerPhone`
  - `customerName`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**
```powershell
cd D:\27\loyalty-backend
node check-customer.js 998901234567
```
(–ó–∞–º–µ–Ω–∏—Ç–µ `998901234567` –Ω–∞ –≤–∞—à –Ω–æ–º–µ—Ä –±–µ–∑ + –∏ –ø—Ä–æ–±–µ–ª–æ–≤)

**–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:**
- ‚úÖ Customer found in database
- ‚úÖ Customer found in iiko
- ‚úÖ Balance: 0

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ iiko Dashboard:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ iiko Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ì–æ—Å—Ç–∏" –∏–ª–∏ "–ö–ª–∏–µ–Ω—Ç—ã"
3. –ù–∞–π–¥–∏—Ç–µ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - ‚úÖ –ö–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω
   - ‚úÖ –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
   - ‚úÖ –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
   - ‚úÖ –ë–∞–ª–∞–Ω—Å = 0

---

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Network tab:

### 1. POST `/api/auth/send-otp`
- Status: **200**
- Response: `{"success": true, "message": "OTP –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω..."}`
- **–î–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ SMS –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω!**

### 2. POST `/api/auth/verify-otp`
- Status: **200**
- Response: `{"success": true, "token": "..."}`

### 3. POST `/api/customers/register`
- Status: **200**
- Response: `{"success": true, "customer": {...}}`
- –í `customer` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
  - `id` - UUID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - `iikoCustomerId` - ID –∏–∑ iiko

---

## ‚úÖ –£—Å–ø–µ—à–Ω—ã–π —Ç–µ—Å—Ç:

–ï—Å–ª–∏ –≤—Å—ë –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ:

- ‚úÖ **SMS –ø—Ä–∏—à–ª–æ** –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä
- ‚úÖ **OTP –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω**
- ‚úÖ **–ö–ª–∏–µ–Ω—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö** (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ `check-customer.js`)
- ‚úÖ **–ö–ª–∏–µ–Ω—Ç –≤ iiko** (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ dashboard –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç)
- ‚úÖ **–ë–∞–ª–∞–Ω—Å = 0** (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ)
- ‚úÖ **Dashboard –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ**

**–¢–æ–≥–¥–∞ –≤—Å—ë –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é!** üéâ

---

## üêõ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### SMS –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å ESKIZ: `node -e "require('dotenv').config(); const eskiz = require('./src/services/sms/eskizService'); eskiz.getBalance().then(r => console.log('Balance:', r.balance));"`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend –Ω–∞ –æ—à–∏–±–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 998XXXXXXXXX)

### –ö–ª–∏–µ–Ω—Ç –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ iiko:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ iiko credentials: `node -e "require('dotenv').config(); console.log('Login:', process.env.IIKO_API_LOGIN); console.log('Org ID:', process.env.IIKO_ORGANIZATION_ID);"`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend –Ω–∞ –æ—à–∏–±–∫–∏ iiko API
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö (–Ω–æ–º–µ—Ä –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤, –¥–∞—Ç–∞ YYYY-MM-DD)

### –ë–∞–ª–∞–Ω—Å –Ω–µ 0:
- –ù–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –≤—Å–µ–≥–¥–∞ –∏–º–µ—é—Ç –±–∞–ª–∞–Ω—Å 0
- –ï—Å–ª–∏ –±–∞–ª–∞–Ω—Å –¥—Ä—É–≥–æ–π - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –±—ã–ª –ª–∏ –∫–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω —Ä–∞–Ω–µ–µ

---

## üìù –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

–°–º–æ—Ç—Ä–∏—Ç–µ `FULL_REGISTRATION_TEST.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—à–∞–≥–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∞.

---

## üéØ –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `.\test-full-registration.ps1` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
2. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:4028/signup`
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å!
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ `check-customer.js`

**–£–¥–∞—á–∏!** üöÄ

